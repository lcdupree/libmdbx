<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libmdbx: Opening &amp; Closing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libmdbx
   &#160;<span id="projectnumber">Please fetch tags and/or use non-obsolete git version.Please fetch tags and/or use non-obsolete git version.Please fetch tags and/or use non-obsolete git version.0 (2022-04-13T11:05:50+03:00)</span>
   </div>
   <div id="projectbrief">One of the fastest compact embeddable key-value ACID database without WAL.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__c__opening.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Opening &amp; Closing<div class="ingroups"><a class="el" href="group__c__api.html">C API</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga316b392e2fa473ddf42874a86bfb60dd"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="group__c__opening.html#ga9138119a904355d245777c4119534061">MDBX_env_flags_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__c__opening.html#ga316b392e2fa473ddf42874a86bfb60dd">MDBX_env_flags_t</a></td></tr>
<tr class="separator:ga316b392e2fa473ddf42874a86bfb60dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga9138119a904355d245777c4119534061"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__c__opening.html#ga9138119a904355d245777c4119534061">MDBX_env_flags_t</a> { <br />
&#160;&#160;<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a261dfd8a866bf0fcf4d3214f30e18d7b">MDBX_ENV_DEFAULTS</a> = 0, 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061ad5c4ae6a8fefe9b05ce17ec3e3bbda4f">MDBX_NOSUBDIR</a> = UINT32_C(0x4000), 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061adc513be607ba103d642f49afc2d50e50">MDBX_RDONLY</a> = UINT32_C(0x20000), 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aa516c74e6fed22c9812bb909c8c459ed">MDBX_EXCLUSIVE</a> = UINT32_C(0x400000), 
<br />
&#160;&#160;<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061ac699e93388dfc6a01a8d652ad0443a24">MDBX_ACCEDE</a> = UINT32_C(0x40000000), 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a9498805abc6c8a3f8345a5c73631cca0">MDBX_WRITEMAP</a> = UINT32_C(0x80000), 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a79e1de212a2f3a1018c2da2c4b511cb8">MDBX_NOTLS</a> = UINT32_C(0x200000), 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a16a07f878f8053cc79990063ca9510e7">MDBX_NORDAHEAD</a> = UINT32_C(0x800000), 
<br />
&#160;&#160;<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aa7a40c9090db0a0c4df61ed0d1d76360">MDBX_NOMEMINIT</a> = UINT32_C(0x1000000), 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a30da8fd3a91328e5719864de3eadeabf">MDBX_COALESCE</a> = UINT32_C(0x2000000), 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a37585486d4e99bcb599cc15b408137b0">MDBX_LIFORECLAIM</a> = UINT32_C(0x4000000), 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a923f8699a2442381a0f1b843c011d74f">MDBX_PAGEPERTURB</a> = UINT32_C(0x8000000), 
<br />
&#160;&#160;<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a8079fe157295e6743580c589af5a063c">MDBX_SYNC_DURABLE</a> = 0, 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a323dae93247c4977621be38614d77b38">MDBX_NOMETASYNC</a> = UINT32_C(0x40000), 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a586d75ff2fd68aed647a60ea7984ed85">MDBX_SAFE_NOSYNC</a> = UINT32_C(0x10000), 
<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aa9fc9f8b1a9a9a8ec58407abf8befbc1">MDBX_MAPASYNC</a> = MDBX_SAFE_NOSYNC, 
<br />
&#160;&#160;<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aec1ed5ccbf0626391088f787ffc4962c">MDBX_UTTERLY_NOSYNC</a> = MDBX_SAFE_NOSYNC | UINT32_C(0x100000)
<br />
 }</td></tr>
<tr class="memdesc:ga9138119a904355d245777c4119534061"><td class="mdescLeft">&#160;</td><td class="mdescRight">Environment flags.  <a href="group__c__opening.html#ga9138119a904355d245777c4119534061">More...</a><br /></td></tr>
<tr class="separator:ga9138119a904355d245777c4119534061"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga109eb833997698fbb77912716596fe8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__c__api.html#ga3ff81c5c75bd3d7836f03a05649d5e8f">LIBMDBX_API</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__c__opening.html#ga109eb833997698fbb77912716596fe8e">mdbx_env_create</a> (<a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> **penv)</td></tr>
<tr class="memdesc:ga109eb833997698fbb77912716596fe8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an MDBX environment instance.  <a href="group__c__opening.html#ga109eb833997698fbb77912716596fe8e">More...</a><br /></td></tr>
<tr class="separator:ga109eb833997698fbb77912716596fe8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabb7dd3b10dd31639ba252df545e11768"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__c__api.html#ga3ff81c5c75bd3d7836f03a05649d5e8f">LIBMDBX_API</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__c__opening.html#gabb7dd3b10dd31639ba252df545e11768">mdbx_env_open</a> (<a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> *env, const char *pathname, <a class="el" href="group__c__opening.html#ga9138119a904355d245777c4119534061">MDBX_env_flags_t</a> flags, <a class="el" href="group__c__api.html#ga209c49f8acf4fd9e042301373c64badb">mdbx_mode_t</a> mode)</td></tr>
<tr class="memdesc:gabb7dd3b10dd31639ba252df545e11768"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open an environment instance.  <a href="group__c__opening.html#gabb7dd3b10dd31639ba252df545e11768">More...</a><br /></td></tr>
<tr class="separator:gabb7dd3b10dd31639ba252df545e11768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa0c00950c8ad451f8674d127d53823fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__c__api.html#ga3ff81c5c75bd3d7836f03a05649d5e8f">LIBMDBX_API</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__c__opening.html#gaa0c00950c8ad451f8674d127d53823fa">mdbx_env_close_ex</a> (<a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> *env, <a class="el" href="group__api__macros.html#gabb452686968e48b67397da5f97445f5b">bool</a> dont_sync)</td></tr>
<tr class="memdesc:gaa0c00950c8ad451f8674d127d53823fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the environment and release the memory map.  <a href="group__c__opening.html#gaa0c00950c8ad451f8674d127d53823fa">More...</a><br /></td></tr>
<tr class="separator:gaa0c00950c8ad451f8674d127d53823fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3945614a024b9f9eb48e4ffa205b68be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__c__opening.html#ga3945614a024b9f9eb48e4ffa205b68be">mdbx_env_close</a> (<a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> *env)</td></tr>
<tr class="memdesc:ga3945614a024b9f9eb48e4ffa205b68be"><td class="mdescLeft">&#160;</td><td class="mdescRight">The shortcut to calling <a class="el" href="group__c__opening.html#gaa0c00950c8ad451f8674d127d53823fa">mdbx_env_close_ex()</a> with the <code>dont_sync=false</code> argument.  <a href="group__c__opening.html#ga3945614a024b9f9eb48e4ffa205b68be">More...</a><br /></td></tr>
<tr class="separator:ga3945614a024b9f9eb48e4ffa205b68be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga316b392e2fa473ddf42874a86bfb60dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga316b392e2fa473ddf42874a86bfb60dd">&#9670;&nbsp;</a></span>MDBX_env_flags_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="group__c__opening.html#ga9138119a904355d245777c4119534061">MDBX_env_flags_t</a> <a class="el" href="group__c__opening.html#ga9138119a904355d245777c4119534061">MDBX_env_flags_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga9138119a904355d245777c4119534061"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9138119a904355d245777c4119534061">&#9670;&nbsp;</a></span>MDBX_env_flags_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__c__opening.html#ga9138119a904355d245777c4119534061">MDBX_env_flags_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Environment flags. </p>
<p><a class="anchor" id="env_flags"></a></p><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__c__opening.html#gabb7dd3b10dd31639ba252df545e11768" title="Open an environment instance.">mdbx_env_open()</a> </dd>
<dd>
<a class="el" href="group__c__settings.html#gaf24ab36da42e5b2b70d02f6027f6d331" title="Set environment flags.">mdbx_env_set_flags()</a> </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061a261dfd8a866bf0fcf4d3214f30e18d7b"></a>MDBX_ENV_DEFAULTS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061ad5c4ae6a8fefe9b05ce17ec3e3bbda4f"></a>MDBX_NOSUBDIR&#160;</td><td class="fielddoc"><p>No environment directory.</p>
<p>By default, MDBX creates its environment in a directory whose pathname is given in path, and creates its data and lock files under that directory. With this option, path is used as-is for the database main data file. The database lock file is the path with "-lck" appended.</p>
<ul>
<li>with <code>MDBX_NOSUBDIR</code> = in a filesystem we have the pair of MDBX-files which names derived from given pathname by appending predefined suffixes.</li>
<li>without <code>MDBX_NOSUBDIR</code> = in a filesystem we have the MDBX-directory with given pathname, within that a pair of MDBX-files with predefined names.</li>
</ul>
<p>This flag affects only at new environment creating by <a class="el" href="group__c__opening.html#gabb7dd3b10dd31639ba252df545e11768">mdbx_env_open()</a>, otherwise at opening an existing environment libmdbx will choice this automatically. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061adc513be607ba103d642f49afc2d50e50"></a>MDBX_RDONLY&#160;</td><td class="fielddoc"><p>Read only mode.</p>
<p>Open the environment in read-only mode. No write operations will be allowed. MDBX will still modify the lock file - except on read-only filesystems, where MDBX does not use locks.</p>
<ul>
<li>with <code>MDBX_RDONLY</code> = open environment in read-only mode. MDBX supports pure read-only mode (i.e. without opening LCK-file) only when environment directory and/or both files are not writable (and the LCK-file may be missing). In such case allowing file(s) to be placed on a network read-only share.</li>
<li>without <code>MDBX_RDONLY</code> = open environment in read-write mode.</li>
</ul>
<p>This flag affects only at environment opening but can't be changed after. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061aa516c74e6fed22c9812bb909c8c459ed"></a>MDBX_EXCLUSIVE&#160;</td><td class="fielddoc"><p>Open environment in exclusive/monopolistic mode.</p>
<p><code>MDBX_EXCLUSIVE</code> flag can be used as a replacement for <code>MDB_NOLOCK</code>, which don't supported by MDBX. In this way, you can get the minimal overhead, but with the correct multi-process and multi-thread locking.</p>
<ul>
<li>with <code>MDBX_EXCLUSIVE</code> = open environment in exclusive/monopolistic mode or return <a class="el" href="group__c__err.html#ggab5ba1469eef28a2e09ed243b608b11cea971ec6ff2bc8db798c920a3bde3bab5d">MDBX_BUSY</a> if environment already used by other process. The main feature of the exclusive mode is the ability to open the environment placed on a network share.</li>
<li>without <code>MDBX_EXCLUSIVE</code> = open environment in cooperative mode, i.e. for multi-process access/interaction/cooperation. The main requirements of the cooperative mode are:<ol type="1">
<li>data files MUST be placed in the LOCAL file system, but NOT on a network share.</li>
<li>environment MUST be opened only by LOCAL processes, but NOT over a network.</li>
<li>OS kernel (i.e. file system and memory mapping implementation) and all processes that open the given environment MUST be running in the physically single RAM with cache-coherency. The only exception for cache-consistency requirement is Linux on MIPS architecture, but this case has not been tested for a long time).</li>
</ol>
</li>
</ul>
<p>This flag affects only at environment opening but can't be changed after. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061ac699e93388dfc6a01a8d652ad0443a24"></a>MDBX_ACCEDE&#160;</td><td class="fielddoc"><p>Using database/environment which already opened by another process(es).</p>
<p>The <code>MDBX_ACCEDE</code> flag is useful to avoid <a class="el" href="group__c__err.html#ggab5ba1469eef28a2e09ed243b608b11ceaf8d7b0a9b9c20a0eab9850268f616666">MDBX_INCOMPATIBLE</a> error while opening the database/environment which is already used by another process(es) with unknown mode/flags. In such cases, if there is a difference in the specified flags (<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a323dae93247c4977621be38614d77b38">MDBX_NOMETASYNC</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a586d75ff2fd68aed647a60ea7984ed85">MDBX_SAFE_NOSYNC</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aec1ed5ccbf0626391088f787ffc4962c">MDBX_UTTERLY_NOSYNC</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a37585486d4e99bcb599cc15b408137b0">MDBX_LIFORECLAIM</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a30da8fd3a91328e5719864de3eadeabf">MDBX_COALESCE</a> and <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a16a07f878f8053cc79990063ca9510e7">MDBX_NORDAHEAD</a>), instead of returning an error, the database will be opened in a compatibility with the already used mode.</p>
<p><code>MDBX_ACCEDE</code> has no effect if the current process is the only one either opening the DB in read-only mode or other process(es) uses the DB in read-only mode. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061a9498805abc6c8a3f8345a5c73631cca0"></a>MDBX_WRITEMAP&#160;</td><td class="fielddoc"><p>Map data into memory with write permission.</p>
<p>Use a writeable memory map unless <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061adc513be607ba103d642f49afc2d50e50">MDBX_RDONLY</a> is set. This uses fewer mallocs and requires much less work for tracking database pages, but loses protection from application bugs like wild pointer writes and other bad updates into the database. This may be slightly faster for DBs that fit entirely in RAM, but is slower for DBs larger than RAM. Also adds the possibility for stray application writes thru pointers to silently corrupt the database.</p>
<ul>
<li>with <code>MDBX_WRITEMAP</code> = all data will be mapped into memory in the read-write mode. This offers a significant performance benefit, since the data will be modified directly in mapped memory and then flushed to disk by single system call, without any memory management nor copying.</li>
<li>without <code>MDBX_WRITEMAP</code> = data will be mapped into memory in the read-only mode. This requires stocking all modified database pages in memory and then writing them to disk through file operations.</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>On the other hand, <code>MDBX_WRITEMAP</code> adds the possibility for stray application writes thru pointers to silently corrupt the database.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The <code>MDBX_WRITEMAP</code> mode is incompatible with nested transactions, since this is unreasonable. I.e. nested transactions requires mallocation of database pages and more work for tracking ones, which neuters a performance boost caused by the <code>MDBX_WRITEMAP</code> mode.</dd></dl>
<p>This flag affects only at environment opening but can't be changed after. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061a79e1de212a2f3a1018c2da2c4b511cb8"></a>MDBX_NOTLS&#160;</td><td class="fielddoc"><p>Tie reader locktable slots to read-only transactions instead of to threads.</p>
<p>Don't use Thread-Local Storage, instead tie reader locktable slots to <a class="el" href="group__c__transactions.html#gad3eb5aa2a23beb3dc6274c46dc236546">MDBX_txn</a> objects instead of to threads. So, <a class="el" href="group__c__transactions.html#gae9f34737fe60b0ba538d5a09b6a25c8d">mdbx_txn_reset()</a> keeps the slot reserved for the <a class="el" href="group__c__transactions.html#gad3eb5aa2a23beb3dc6274c46dc236546">MDBX_txn</a> object. A thread may use parallel read-only transactions. And a read-only transaction may span threads if you synchronizes its use.</p>
<p>Applications that multiplex many user threads over individual OS threads need this option. Such an application must also serialize the write transactions in an OS thread, since MDBX's write locking is unaware of the user threads.</p>
<dl class="section note"><dt>Note</dt><dd>Regardless to <code>MDBX_NOTLS</code> flag a write transaction entirely should always be used in one thread from start to finish. MDBX checks this in a reasonable manner and return the <a class="el" href="group__c__err.html#ggab5ba1469eef28a2e09ed243b608b11cea7f9a4b39c6651951ab40a33641eb8279">MDBX_THREAD_MISMATCH</a> error in rules violation.</dd></dl>
<p>This flag affects only at environment opening but can't be changed after. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061a16a07f878f8053cc79990063ca9510e7"></a>MDBX_NORDAHEAD&#160;</td><td class="fielddoc"><p>Don't do readahead.</p>
<p>Turn off readahead. Most operating systems perform readahead on read requests by default. This option turns it off if the OS supports it. Turning it off may help random read performance when the DB is larger than RAM and system RAM is full.</p>
<p>By default libmdbx dynamically enables/disables readahead depending on the actual database size and currently available memory. On the other hand, such automation has some limitation, i.e. could be performed only when DB size changing but can't tracks and reacts changing a free RAM availability, since it changes independently and asynchronously.</p>
<dl class="section note"><dt>Note</dt><dd>The <a class="el" href="group__c__extra.html#ga47868c0824f38ee163fa01aaf16b58a6" title="Find out whether to use readahead or not, based on the given database size and the amount of availabl...">mdbx_is_readahead_reasonable()</a> function allows to quickly find out whether to use readahead or not based on the size of the data and the amount of available memory.</dd></dl>
<p>This flag affects only at environment opening and can't be changed after. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061aa7a40c9090db0a0c4df61ed0d1d76360"></a>MDBX_NOMEMINIT&#160;</td><td class="fielddoc"><p>Don't initialize malloc'ed memory before writing to datafile.</p>
<p>Don't initialize malloc'ed memory before writing to unused spaces in the data file. By default, memory for pages written to the data file is obtained using malloc. While these pages may be reused in subsequent transactions, freshly malloc'ed pages will be initialized to zeroes before use. This avoids persisting leftover data from other code (that used the heap and subsequently freed the memory) into the data file.</p>
<p>Note that many other system libraries may allocate and free memory from the heap for arbitrary uses. E.g., stdio may use the heap for file I/O buffers. This initialization step has a modest performance cost so some applications may want to disable it using this flag. This option can be a problem for applications which handle sensitive data like passwords, and it makes memory checkers like Valgrind noisy. This flag is not needed with <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a9498805abc6c8a3f8345a5c73631cca0">MDBX_WRITEMAP</a>, which writes directly to the mmap instead of using malloc for pages. The initialization is also skipped if <a class="el" href="group__c__crud.html#gga5b8137591c45143c6d9439799be77136abbdedd48fe94bb9b50c467d1b920f959">MDBX_RESERVE</a> is used; the caller is expected to overwrite all of the memory that was reserved in that case.</p>
<p>This flag may be changed at any time using <code><a class="el" href="group__c__settings.html#gaf24ab36da42e5b2b70d02f6027f6d331" title="Set environment flags.">mdbx_env_set_flags()</a></code>. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061a30da8fd3a91328e5719864de3eadeabf"></a>MDBX_COALESCE&#160;</td><td class="fielddoc"><p>Aims to coalesce a Garbage Collection items.</p>
<p>With <code>MDBX_COALESCE</code> flag MDBX will aims to coalesce items while recycling a Garbage Collection. Technically, when possible short lists of pages will be combined into longer ones, but to fit on one database page. As a result, there will be fewer items in Garbage Collection and a page lists are longer, which slightly increases the likelihood of returning pages to Unallocated space and reducing the database file.</p>
<p>This flag may be changed at any time using <a class="el" href="group__c__settings.html#gaf24ab36da42e5b2b70d02f6027f6d331" title="Set environment flags.">mdbx_env_set_flags()</a>. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061a37585486d4e99bcb599cc15b408137b0"></a>MDBX_LIFORECLAIM&#160;</td><td class="fielddoc"><p>LIFO policy for recycling a Garbage Collection items.</p>
<p><code>MDBX_LIFORECLAIM</code> flag turns on LIFO policy for recycling a Garbage Collection items, instead of FIFO by default. On systems with a disk write-back cache, this can significantly increase write performance, up to several times in a best case scenario.</p>
<p>LIFO recycling policy means that for reuse pages will be taken which became unused the lastest (i.e. just now or most recently). Therefore the loop of database pages circulation becomes as short as possible. In other words, the number of pages, that are overwritten in memory and on disk during a series of write transactions, will be as small as possible. Thus creates ideal conditions for the efficient operation of the disk write-back cache.</p>
<p><a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a37585486d4e99bcb599cc15b408137b0">MDBX_LIFORECLAIM</a> is compatible with all no-sync flags, but gives NO noticeable impact in combination with <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a586d75ff2fd68aed647a60ea7984ed85">MDBX_SAFE_NOSYNC</a> or <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aec1ed5ccbf0626391088f787ffc4962c">MDBX_UTTERLY_NOSYNC</a>. Because MDBX will reused pages only before the last "steady" MVCC-snapshot, i.e. the loop length of database pages circulation will be mostly defined by frequency of calling <a class="el" href="group__c__extra.html#ga2d26ce1c3337fd792ed5ca2b598d163c">mdbx_env_sync()</a> rather than LIFO and FIFO difference.</p>
<p>This flag may be changed at any time using <a class="el" href="group__c__settings.html#gaf24ab36da42e5b2b70d02f6027f6d331" title="Set environment flags.">mdbx_env_set_flags()</a>. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061a923f8699a2442381a0f1b843c011d74f"></a>MDBX_PAGEPERTURB&#160;</td><td class="fielddoc"><p>Debugging option, fill/perturb released pages. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061a8079fe157295e6743580c589af5a063c"></a>MDBX_SYNC_DURABLE&#160;</td><td class="fielddoc"><p>Default robust and durable sync mode.</p>
<p>Metadata is written and flushed to disk after a data is written and flushed, which guarantees the integrity of the database in the event of a crash at any time.</p>
<dl class="section attention"><dt>Attention</dt><dd>Please do not use other modes until you have studied all the details and are sure. Otherwise, you may lose your users' data, as happens in <a href="https://www.miranda-ng.org/">Miranda NG</a> messenger. </dd></dl>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061a323dae93247c4977621be38614d77b38"></a>MDBX_NOMETASYNC&#160;</td><td class="fielddoc"><p>Don't sync the meta-page after commit.</p>
<p>Flush system buffers to disk only once per transaction commit, omit the metadata flush. Defer that until the system flushes files to disk, or next non-<a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061adc513be607ba103d642f49afc2d50e50">MDBX_RDONLY</a> commit or <a class="el" href="group__c__extra.html#ga2d26ce1c3337fd792ed5ca2b598d163c">mdbx_env_sync()</a>. Depending on the platform and hardware, with <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a323dae93247c4977621be38614d77b38">MDBX_NOMETASYNC</a> you may get a doubling of write performance.</p>
<p>This trade-off maintains database integrity, but a system crash may undo the last committed transaction. I.e. it preserves the ACI (atomicity, consistency, isolation) but not D (durability) database property.</p>
<p><code>MDBX_NOMETASYNC</code> flag may be changed at any time using <a class="el" href="group__c__settings.html#gaf24ab36da42e5b2b70d02f6027f6d331">mdbx_env_set_flags()</a> or by passing to <a class="el" href="group__c__transactions.html#ga9621bd463ec9efb2373f25dfb016938a">mdbx_txn_begin()</a> for particular write transaction. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__sync__modes.html">SYNC MODES</a> </dd></dl>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061a586d75ff2fd68aed647a60ea7984ed85"></a>MDBX_SAFE_NOSYNC&#160;</td><td class="fielddoc"><p>Don't sync anything but keep previous steady commits.</p>
<p>Like <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aec1ed5ccbf0626391088f787ffc4962c">MDBX_UTTERLY_NOSYNC</a> the <code>MDBX_SAFE_NOSYNC</code> flag disable similarly flush system buffers to disk when committing a transaction. But there is a huge difference in how are recycled the MVCC snapshots corresponding to previous "steady" transactions (see below).</p>
<p>With <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a9498805abc6c8a3f8345a5c73631cca0">MDBX_WRITEMAP</a> the <code>MDBX_SAFE_NOSYNC</code> instructs MDBX to use asynchronous mmap-flushes to disk. Asynchronous mmap-flushes means that actually all writes will scheduled and performed by operation system on it own manner, i.e. unordered. MDBX itself just notify operating system that it would be nice to write data to disk, but no more.</p>
<p>Depending on the platform and hardware, with <code>MDBX_SAFE_NOSYNC</code> you may get a multiple increase of write performance, even 10 times or more.</p>
<p>In contrast to <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aec1ed5ccbf0626391088f787ffc4962c">MDBX_UTTERLY_NOSYNC</a> mode, with <code>MDBX_SAFE_NOSYNC</code> flag MDBX will keeps untouched pages within B-tree of the last transaction "steady" which was synced to disk completely. This has big implications for both data durability and (unfortunately) performance:</p><ul>
<li>a system crash can't corrupt the database, but you will lose the last transactions; because MDBX will rollback to last steady commit since it kept explicitly.</li>
<li>the last steady transaction makes an effect similar to "long-lived" read transaction (see above in the <a class="el" href="intro.html#restrictions">Restrictions &amp; Caveats</a> section) since prevents reuse of pages freed by newer write transactions, thus the any data changes will be placed in newly allocated pages.</li>
<li>to avoid rapid database growth, the system will sync data and issue a steady commit-point to resume reuse pages, each time there is insufficient space and before increasing the size of the file on disk.</li>
</ul>
<p>In other words, with <code>MDBX_SAFE_NOSYNC</code> flag MDBX insures you from the whole database corruption, at the cost increasing database size and/or number of disk IOPs. So, <code>MDBX_SAFE_NOSYNC</code> flag could be used with <a class="el" href="group__c__extra.html#ga2d26ce1c3337fd792ed5ca2b598d163c">mdbx_env_sync()</a> as alternatively for batch committing or nested transaction (in some cases). As well, auto-sync feature exposed by <a class="el" href="group__c__settings.html#ga7e64d98f7a8c3bdf7727627782f1be0a">mdbx_env_set_syncbytes()</a> and <a class="el" href="group__c__settings.html#ga465c4c08a727aef512b8e0838b236d4a">mdbx_env_set_syncperiod()</a> functions could be very useful with <code>MDBX_SAFE_NOSYNC</code> flag.</p>
<p>The number and volume of of disk IOPs with MDBX_SAFE_NOSYNC flag will exactly the as without any no-sync flags. However, you should expect a larger process's <a href="https://bit.ly/2kA2tFX">work set</a> and significantly worse a <a href="https://bit.ly/2mbYq2J">locality of reference</a>, due to the more intensive allocation of previously unused pages and increase the size of the database.</p>
<p><code>MDBX_SAFE_NOSYNC</code> flag may be changed at any time using <a class="el" href="group__c__settings.html#gaf24ab36da42e5b2b70d02f6027f6d331">mdbx_env_set_flags()</a> or by passing to <a class="el" href="group__c__transactions.html#ga9621bd463ec9efb2373f25dfb016938a">mdbx_txn_begin()</a> for particular write transaction. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061aa9fc9f8b1a9a9a8ec58407abf8befbc1"></a>MDBX_MAPASYNC&#160;</td><td class="fielddoc"><dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000008">Deprecated:</a></b></dt><dd>Please use <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a586d75ff2fd68aed647a60ea7984ed85">MDBX_SAFE_NOSYNC</a> instead of <code>MDBX_MAPASYNC</code>.</dd></dl>
<p>Since version 0.9.x the <code>MDBX_MAPASYNC</code> is deprecated and has the same effect as <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a586d75ff2fd68aed647a60ea7984ed85">MDBX_SAFE_NOSYNC</a> with <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a9498805abc6c8a3f8345a5c73631cca0">MDBX_WRITEMAP</a>. This just API simplification is for convenience and clarity. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga9138119a904355d245777c4119534061aec1ed5ccbf0626391088f787ffc4962c"></a>MDBX_UTTERLY_NOSYNC&#160;</td><td class="fielddoc"><p>Don't sync anything and wipe previous steady commits.</p>
<p>Don't flush system buffers to disk when committing a transaction. This optimization means a system crash can corrupt the database, if buffers are not yet flushed to disk. Depending on the platform and hardware, with <code>MDBX_UTTERLY_NOSYNC</code> you may get a multiple increase of write performance, even 100 times or more.</p>
<p>If the filesystem preserves write order (which is rare and never provided unless explicitly noted) and the <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a9498805abc6c8a3f8345a5c73631cca0">MDBX_WRITEMAP</a> and <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a37585486d4e99bcb599cc15b408137b0">MDBX_LIFORECLAIM</a> flags are not used, then a system crash can't corrupt the database, but you can lose the last transactions, if at least one buffer is not yet flushed to disk. The risk is governed by how often the system flushes dirty buffers to disk and how often <a class="el" href="group__c__extra.html#ga2d26ce1c3337fd792ed5ca2b598d163c">mdbx_env_sync()</a> is called. So, transactions exhibit ACI (atomicity, consistency, isolation) properties and only lose <code>D</code> (durability). I.e. database integrity is maintained, but a system crash may undo the final transactions.</p>
<p>Otherwise, if the filesystem not preserves write order (which is typically) or <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a9498805abc6c8a3f8345a5c73631cca0">MDBX_WRITEMAP</a> or <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a37585486d4e99bcb599cc15b408137b0">MDBX_LIFORECLAIM</a> flags are used, you should expect the corrupted database after a system crash.</p>
<p>So, most important thing about <code>MDBX_UTTERLY_NOSYNC</code>:</p><ul>
<li>a system crash immediately after commit the write transaction high likely lead to database corruption.</li>
<li>successful completion of mdbx_env_sync(force = true) after one or more committed transactions guarantees consistency and durability.</li>
<li>BUT by committing two or more transactions you back database into a weak state, in which a system crash may lead to database corruption! In case single transaction after mdbx_env_sync, you may lose transaction itself, but not a whole database.</li>
</ul>
<p>Nevertheless, <code>MDBX_UTTERLY_NOSYNC</code> provides "weak" durability in case of an application crash (but no durability on system failure), and therefore may be very useful in scenarios where data durability is not required over a system failure (e.g for short-lived data), or if you can take such risk.</p>
<p><code>MDBX_UTTERLY_NOSYNC</code> flag may be changed at any time using <a class="el" href="group__c__settings.html#gaf24ab36da42e5b2b70d02f6027f6d331">mdbx_env_set_flags()</a>, but don't has effect if passed to <a class="el" href="group__c__transactions.html#ga9621bd463ec9efb2373f25dfb016938a">mdbx_txn_begin()</a> for particular write transaction. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__sync__modes.html">SYNC MODES</a> </dd></dl>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga3945614a024b9f9eb48e4ffa205b68be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3945614a024b9f9eb48e4ffa205b68be">&#9670;&nbsp;</a></span>mdbx_env_close()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int mdbx_env_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> *&#160;</td>
          <td class="paramname"><em>env</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The shortcut to calling <a class="el" href="group__c__opening.html#gaa0c00950c8ad451f8674d127d53823fa">mdbx_env_close_ex()</a> with the <code>dont_sync=false</code> argument. </p>

</div>
</div>
<a id="gaa0c00950c8ad451f8674d127d53823fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa0c00950c8ad451f8674d127d53823fa">&#9670;&nbsp;</a></span>mdbx_env_close_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__c__api.html#ga3ff81c5c75bd3d7836f03a05649d5e8f">LIBMDBX_API</a> int mdbx_env_close_ex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> *&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__api__macros.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>dont_sync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the environment and release the memory map. </p>
<p>Only a single thread may call this function. All transactions, databases, and cursors must already be closed before calling this function. Attempts to use any such handles after calling this function will cause a <code>SIGSEGV</code>. The environment handle will be freed and must not be used again after this call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>An environment handle returned by <a class="el" href="group__c__opening.html#ga109eb833997698fbb77912716596fe8e">mdbx_env_create()</a>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dont_sync</td><td>A dont'sync flag, if non-zero the last checkpoint will be kept "as is" and may be still "weak" in the <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a586d75ff2fd68aed647a60ea7984ed85">MDBX_SAFE_NOSYNC</a> or <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aec1ed5ccbf0626391088f787ffc4962c">MDBX_UTTERLY_NOSYNC</a> modes. Such "weak" checkpoint will be ignored on opening next time, and transactions since the last non-weak checkpoint (meta-page update) will rolledback for consistency guarantee.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A non-zero error value on failure and 0 on success, some possible errors are: </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">MDBX_BUSY</td><td>The write transaction is running by other thread, in such case <a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> instance has NOT be destroyed not released! </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>If any OTHER error code was returned then given MDBX_env instance has been destroyed and released.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">MDBX_EBADSIGN</td><td>Environment handle already closed or not valid, i.e. <a class="el" href="group__c__opening.html#ga3945614a024b9f9eb48e4ffa205b68be">mdbx_env_close()</a> was already called for the <code>env</code> or was not created by <a class="el" href="group__c__opening.html#ga109eb833997698fbb77912716596fe8e">mdbx_env_create()</a>.</td></tr>
    <tr><td class="paramname">MDBX_PANIC</td><td>If <a class="el" href="group__c__opening.html#gaa0c00950c8ad451f8674d127d53823fa">mdbx_env_close_ex()</a> was called in the child process after <code>fork()</code>. In this case <a class="el" href="group__c__err.html#ggab5ba1469eef28a2e09ed243b608b11cea0174b5b0e54675e8195c1a590d1f1a0d">MDBX_PANIC</a> is expected, i.e. <a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> instance was freed in proper manner.</td></tr>
    <tr><td class="paramname">MDBX_EIO</td><td>An error occurred during synchronization. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga109eb833997698fbb77912716596fe8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga109eb833997698fbb77912716596fe8e">&#9670;&nbsp;</a></span>mdbx_env_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__c__api.html#ga3ff81c5c75bd3d7836f03a05649d5e8f">LIBMDBX_API</a> int mdbx_env_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> **&#160;</td>
          <td class="paramname"><em>penv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create an MDBX environment instance. </p>
<p>This function allocates memory for a <a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> structure. To release the allocated memory and discard the handle, call <a class="el" href="group__c__opening.html#ga3945614a024b9f9eb48e4ffa205b68be">mdbx_env_close()</a>. Before the handle may be used, it must be opened using <a class="el" href="group__c__opening.html#gabb7dd3b10dd31639ba252df545e11768">mdbx_env_open()</a>.</p>
<p>Various other options may also need to be set before opening the handle, e.g. <a class="el" href="group__c__settings.html#ga79065e4f3c5fb2ad37a52b59224d583e">mdbx_env_set_geometry()</a>, <a class="el" href="group__c__settings.html#gadefa6e24ea453f2631fb6cc7871cfda6">mdbx_env_set_maxreaders()</a>, <a class="el" href="group__c__settings.html#ga39ab74bb9bbfaab1cc586642fec4559a">mdbx_env_set_maxdbs()</a>, depending on usage requirements.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">penv</td><td>The address where the new handle will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a non-zero error value on failure and 0 on success. </dd></dl>

</div>
</div>
<a id="gabb7dd3b10dd31639ba252df545e11768"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabb7dd3b10dd31639ba252df545e11768">&#9670;&nbsp;</a></span>mdbx_env_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__c__api.html#ga3ff81c5c75bd3d7836f03a05649d5e8f">LIBMDBX_API</a> int mdbx_env_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> *&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pathname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__c__opening.html#ga9138119a904355d245777c4119534061">MDBX_env_flags_t</a>&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__c__api.html#ga209c49f8acf4fd9e042301373c64badb">mdbx_mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open an environment instance. </p>
<p>Indifferently this function will fails or not, the <a class="el" href="group__c__opening.html#ga3945614a024b9f9eb48e4ffa205b68be">mdbx_env_close()</a> must be called later to discard the <a class="el" href="group__c__api.html#gaaf0e4c9dc12dce0c2a98566436c94222">MDBX_env</a> handle and release associated resources.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>An environment handle returned by <a class="el" href="group__c__opening.html#ga109eb833997698fbb77912716596fe8e">mdbx_env_create()</a></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pathname</td><td>The pathname for the database or the directory in which the database files reside. In the case of directory it must already exist and be writable.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Specifies options for this environment. This parameter must be bitwise OR'ing together any constants described above in the <a class="el" href="group__c__opening.html#env_flags">env_flags</a> and <a class="el" href="group__sync__modes.html">SYNC MODES</a> sections.</td></tr>
  </table>
  </dd>
</dl>
<p>Flags set by <a class="el" href="group__c__settings.html#gaf24ab36da42e5b2b70d02f6027f6d331" title="Set environment flags.">mdbx_env_set_flags()</a> are also used:</p><ul>
<li><a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a261dfd8a866bf0fcf4d3214f30e18d7b">MDBX_ENV_DEFAULTS</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061ad5c4ae6a8fefe9b05ce17ec3e3bbda4f">MDBX_NOSUBDIR</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061adc513be607ba103d642f49afc2d50e50">MDBX_RDONLY</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aa516c74e6fed22c9812bb909c8c459ed">MDBX_EXCLUSIVE</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a9498805abc6c8a3f8345a5c73631cca0">MDBX_WRITEMAP</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a79e1de212a2f3a1018c2da2c4b511cb8">MDBX_NOTLS</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a16a07f878f8053cc79990063ca9510e7">MDBX_NORDAHEAD</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aa7a40c9090db0a0c4df61ed0d1d76360">MDBX_NOMEMINIT</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a30da8fd3a91328e5719864de3eadeabf">MDBX_COALESCE</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a37585486d4e99bcb599cc15b408137b0">MDBX_LIFORECLAIM</a>. See <a class="el" href="group__c__opening.html#env_flags">env_flags</a> section.</li>
<li><a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a8079fe157295e6743580c589af5a063c">MDBX_SYNC_DURABLE</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a323dae93247c4977621be38614d77b38">MDBX_NOMETASYNC</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a586d75ff2fd68aed647a60ea7984ed85">MDBX_SAFE_NOSYNC</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aec1ed5ccbf0626391088f787ffc4962c">MDBX_UTTERLY_NOSYNC</a>. See <a class="el" href="group__sync__modes.html">SYNC MODES</a> section.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><code>MDB_NOLOCK</code> flag don't supported by MDBX, try use <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aa516c74e6fed22c9812bb909c8c459ed">MDBX_EXCLUSIVE</a> as a replacement.</dd>
<dd>
MDBX don't allow to mix processes with different <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a586d75ff2fd68aed647a60ea7984ed85">MDBX_SAFE_NOSYNC</a> flags on the same environment. In such case <a class="el" href="group__c__err.html#ggab5ba1469eef28a2e09ed243b608b11ceaf8d7b0a9b9c20a0eab9850268f616666">MDBX_INCOMPATIBLE</a> will be returned.</dd></dl>
<p>If the database is already exist and parameters specified early by <a class="el" href="group__c__settings.html#ga79065e4f3c5fb2ad37a52b59224d583e">mdbx_env_set_geometry()</a> are incompatible (i.e. for instance, different page size) then <a class="el" href="group__c__opening.html#gabb7dd3b10dd31639ba252df545e11768">mdbx_env_open()</a> will return <a class="el" href="group__c__err.html#ggab5ba1469eef28a2e09ed243b608b11ceaf8d7b0a9b9c20a0eab9850268f616666">MDBX_INCOMPATIBLE</a> error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>The UNIX permissions to set on created files. Zero value means to open existing, but do not create.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A non-zero error value on failure and 0 on success, some possible errors are: </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">MDBX_VERSION_MISMATCH</td><td>The version of the MDBX library doesn't match the version that created the database environment. </td></tr>
    <tr><td class="paramname">MDBX_INVALID</td><td>The environment file headers are corrupted. </td></tr>
    <tr><td class="paramname">MDBX_ENOENT</td><td>The directory specified by the path parameter doesn't exist. </td></tr>
    <tr><td class="paramname">MDBX_EACCES</td><td>The user didn't have permission to access the environment files. </td></tr>
    <tr><td class="paramname">MDBX_EAGAIN</td><td>The environment was locked by another process. </td></tr>
    <tr><td class="paramname">MDBX_BUSY</td><td>The <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aa516c74e6fed22c9812bb909c8c459ed">MDBX_EXCLUSIVE</a> flag was specified and the environment is in use by another process, or the current process tries to open environment more than once. </td></tr>
    <tr><td class="paramname">MDBX_INCOMPATIBLE</td><td>Environment is already opened by another process, but with different set of <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061a586d75ff2fd68aed647a60ea7984ed85">MDBX_SAFE_NOSYNC</a>, <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061aec1ed5ccbf0626391088f787ffc4962c">MDBX_UTTERLY_NOSYNC</a> flags. Or if the database is already exist and parameters specified early by <a class="el" href="group__c__settings.html#ga79065e4f3c5fb2ad37a52b59224d583e">mdbx_env_set_geometry()</a> are incompatible (i.e. different pagesize, etc).</td></tr>
    <tr><td class="paramname">MDBX_WANNA_RECOVERY</td><td>The <a class="el" href="group__c__opening.html#gga9138119a904355d245777c4119534061adc513be607ba103d642f49afc2d50e50">MDBX_RDONLY</a> flag was specified but read-write access is required to rollback inconsistent state after a system crash.</td></tr>
    <tr><td class="paramname">MDBX_TOO_LARGE</td><td>Database is too large for this process, i.e. 32-bit process tries to open &gt;4Gb database. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
